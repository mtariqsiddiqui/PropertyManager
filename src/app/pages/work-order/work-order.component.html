<div class="flex flex-col gap-6" *ngIf="workOrder">
  <div class="flex items-center gap-4">
    <a [routerLink]="['/complaints', workOrder.complaintId]" class="inline-flex items-center justify-center rounded-md text-sm font-medium h-10 w-10 bg-background text-foreground border border-input">
      <i-lucide [img]="lucidearrowleft" class="h-4 w-4"></i-lucide>
      <span class="sr-only">Back</span>
    </a>
    <h2 class="text-2xl font-bold tracking-tight">Work Order</h2>
  </div>

  <div class="grid gap-6 md:grid-cols-3">
    <div class="rounded-lg border bg-card text-card-foreground shadow-sm md:col-span-2">
      <div class="p-6">
        <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
          <div>
            <h3 class="text-xl font-semibold">{{ workOrder.subject }}</h3>
            <p class="text-sm text-muted-foreground">
              Work Order ID: {{ workOrder.id }} | Complaint ID: {{ workOrder.complaintId }}
            </p>
          </div>
          <div class="flex flex-wrap gap-2">
                <span [ngClass]="getStatusClass(workOrder.status)" class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold">
                  {{ getStatusText(workOrder.status) }}
                </span>
            <span [ngClass]="getPriorityClass(workOrder.priority)" class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold text-white">
                  {{ getPriorityText(workOrder.priority) }}
                </span>
          </div>
        </div>
      </div>
      <div class="p-6 pt-0 grid gap-6">
        <div>
          <h4 class="mb-2 font-semibold">Description</h4>
          <p class="text-sm text-muted-foreground">{{ workOrder.description }}</p>
        </div>

        <div *ngIf="workOrder.hasImage">
          <h4 class="mb-2 font-semibold">Attached Images</h4>
          <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3">
            <div class="overflow-hidden rounded-md border">
              <img
                src="/placeholder.svg?height=300&width=400"
                alt="Complaint image"
                class="h-[200px] w-full object-cover"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="flex flex-col gap-6">
      <div class="rounded-lg border bg-card text-card-foreground shadow-sm">
        <div class="p-6">
          <h3 class="text-lg font-semibold">Work Order Management</h3>
        </div>
        <div class="p-6 pt-0 grid gap-4">
          <div class="grid gap-2">
            <label for="status" class="text-sm font-medium">Status</label>
            <select
              id="status"
              [(ngModel)]="workOrder.status"
              class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"
            >
              <option value="pending">Pending</option>
              <option value="in-progress">In Progress</option>
              <option value="resolved">Resolved</option>
            </select>
          </div>

          <div class="grid gap-2">
            <label for="technician" class="text-sm font-medium">Assign Technician</label>
            <select
              id="technician"
              [(ngModel)]="workOrder.assignedTechnician"
              class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"
            >
              <option value="">Select technician</option>
              @for (tech of technicians; track tech.id) {
                <option [value]="tech.id">{{ tech.name }} ({{ tech.specialization }})</option>
              }
            </select>
          </div>

          <div class="grid gap-2">
            <label for="notes" class="text-sm font-medium">Work Notes</label>
            <textarea
              id="notes"
              [(ngModel)]="workOrder.notes"
              placeholder="Add notes about the work order..."
              class="flex min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm"
            ></textarea>
          </div>

          <button
            (click)="saveChanges()"
            class="inline-flex items-center justify-center rounded-md text-sm font-medium h-10 px-4 py-2 bg-primary text-primary-foreground w-full"
          >
            Save Changes
          </button>
        </div>
      </div>

      <div class="rounded-lg border bg-card text-card-foreground shadow-sm">
        <div class="p-6">
          <h3 class="text-lg font-semibold">Property Information</h3>
        </div>
        <div class="p-6 pt-0 grid gap-4">
          <div class="flex items-center gap-3">
            <i class="lucide-map-pin h-4 w-4 text-muted-foreground"></i>
            <div>
              <p class="text-sm font-medium">Property</p>
              <p class="text-sm text-muted-foreground">{{ workOrder.property }}</p>
            </div>
          </div>
          <div class="flex items-center gap-3">
            <i class="lucide-map-pin h-4 w-4 text-muted-foreground"></i>
            <div>
              <p class="text-sm font-medium">Location</p>
              <p class="text-sm text-muted-foreground">{{ workOrder.location }}</p>
            </div>
          </div>
          <hr class="border-t" />
          <div class="flex items-center gap-3">
            <i class="lucide-user h-4 w-4 text-muted-foreground"></i>
            <div>
              <p class="text-sm font-medium">Reporter</p>
              <p class="text-sm text-muted-foreground">{{ workOrder.reporter.name }}</p>
            </div>
          </div>
          <div class="flex items-center gap-3">
            <i class="lucide-calendar h-4 w-4 text-muted-foreground"></i>
            <div>
              <p class="text-sm font-medium">Reported</p>
              <p class="text-sm text-muted-foreground">{{ workOrder.date }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
